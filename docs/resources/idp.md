---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "iamtf_idp Resource - terraform-provider-iamtf"
subcategory: ""
description: |-
  
---

# iamtf_idp (Resource)





This is one of the key resources available in JOSSO.  It allows you to define an identity provider. JOSSO supports multiple identity protocols, you can connect any SP using: 

* OpenID Connect 1.0
* OAuth 2.0
* SAML 2.0
* JOSSO 1.0
* Custom

You can mix heterogeneouse service providers that have different requireminets and connect them with a single IDP. For example, you can share identity between SAML and OIDC applications transparently, providing users with a single authentication experience.

To configure an IDP you must provide an **identity source**, an **authentication mechanism** and a **keystore**.  Then you need to define each **service provider**, and reference the trusted IDP.

In JOSSO you can have multiple identity providers running in a single identity appliance.

Let's take a look at the following example:

```
resource "iamtf_idp" "idp" {
  
  ida  = iamtf_identity_appliance.ida-1.name
  
  name = "idp"

  keystore {
    resource = filebase64("./idp.p12")
    password = "changeme"
  }

  id_sources = [iamtf_idvault.sso-users.name]

  authn_basic {
    priority          = 0         
    pwd_hash          = "SHA-256"
    pwd_encoding      = "BASE64"
  }

  depends_on = [
    iamtf_idvault.sso-users
  ]

}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `ida` (String) identity appliane name
- `keystore` (Block List, Min: 1) Keystore configuration.  A single keystore containing the private key and certificate is supported. (see [below for nested schema](#nestedblock--keystore))
- `name` (String) idp name, unique in the appliance scope

### Optional

- `attributes` (Block List, Max: 1) attributes mappings.  Define IdP claim mappings. (see [below for nested schema](#nestedblock--attributes))
- `authn_basic` (Block List) Basic authentication settings. JOSSO will verify user provided credentials (username, password) with stored values in an identity source (see [below for nested schema](#nestedblock--authn_basic))
- `authn_bind_ldap` (Block List) LDAP bind authentication settings (see [below for nested schema](#nestedblock--authn_bind_ldap))
- `authn_client_cert` (Block List) Basic authentication settings. JOSSO will verify user provided credentials (username, password) with stored values in an identity source (see [below for nested schema](#nestedblock--authn_client_cert))
- `authn_oauth2_pre` (Block List) Basic authentication settings. JOSSO will verify user provided credentials (username, password) with stored values in an identity source (see [below for nested schema](#nestedblock--authn_oauth2_pre))
- `authn_wia` (Block List) Windows Integrated Authentication. JOSSO will verify identity by contacting a domain controller (see [below for nested schema](#nestedblock--authn_wia))
- `branding` (String) the name of the UI branding plugin installed in JOSSO
- `dashboard_url` (String) External user dashborad URL
- `description` (String) provider description
- `destroy_previous_session` (Boolean) JOSSO will logout an existing session to avoid exceeding the max session per user. if false, login will be  denied after reaching the max.
- `error_binding` (String) how error information is encoded and shared with a custom user dashboard
- `id_sources` (Set of String) list of identity sources used by the IDP.  At least one is required.
- `max_sessions_per_user` (Number) Max number of sessions per user, -1 unbounded. This will limit the amount of simutaneous SSO sessions a user can create.  Works in combination with **destroy_previous_session**.
- `oauth2` (Block List, Max: 1) OAuth2 protocol settings.  This is maily used by JOSSO internally, for SSO connetions OpenID Connect is the recommended protocol, which is a superset of OAuth2 (see [below for nested schema](#nestedblock--oauth2))
- `oidc` (Block List, Max: 1) OpenID Connect protocol settings.  This is the recommended SSO protocol. You must combine this with **iamtf_app_odic** resources (Applications) (see [below for nested schema](#nestedblock--oidc))
- `saml2` (Block List, Max: 1) IDP SAML2 protocol settings (see [below for nested schema](#nestedblock--saml2))
- `session_timeout` (Number) SSO session timeout (minutes, default 30)
- `sp` (Block List) IDP to SP SAML 2 settings (see [below for nested schema](#nestedblock--sp))
- `subject_authn_policies` (Block List) todo add description for subject authens policies (see [below for nested schema](#nestedblock--subject_authn_policies))

### Read-Only

- `element_id` (String) element id
- `id` (String) The ID of this resource.

<a id="nestedblock--keystore"></a>
### Nested Schema for `keystore`

Required:

- `password` (String, Sensitive) PKCS12 keystore password
- `resource` (String) PKCS12 keystore in base64 format

Optional:

- `alias` (String) Ceertificate and private key alias (optional)
- `key_password` (String, Sensitive) PKCS12 private key password (optional, the store password is used if not present)


<a id="nestedblock--attributes"></a>
### Nested Schema for `attributes`

Optional:

- `include_unmapped_claims` (Boolean) when using a custom profile, include unmapped claims
- `map` (Block Set) Custom attribute mappings (see [below for nested schema](#nestedblock--attributes--map))
- `profile` (String) Attribute profile to use

<a id="nestedblock--attributes--map"></a>
### Nested Schema for `attributes.map`

Required:

- `mapping` (String) value to us when doing the mapping, depending on the type this will be an existing claim name, a constant value or an expresison value
- `name` (String) name of the new claim

Optional:

- `format` (String) how the new claim name should be formatted.  Basic if the name will be used as is, URN to add a default SAML2 urn to the claim
- `type` (String) mapping type.  claim if you want to man an existing claim to a new name.  const if you want to add a new constant value as claim.  exp if you want to create a claim using an expression



<a id="nestedblock--authn_basic"></a>
### Nested Schema for `authn_basic`

Optional:

- `crypt_salt_length` (Number) crypt salt length (in bytes: 0, 8, 16, 24, 32, 48, 64, 128, 256)
- `extension` (Block List) Allows you to use a custom component for a given resource.  Components are installed as OSGi bundles in the server.  You can refer to a component instance or create a new instance based on its class (see [below for nested schema](#nestedblock--authn_basic--extension))
- `priority` (Number) authentiacation priority compared to other mechanisms (ascening order)
- `pwd_encoding` (String) password encoding algorithm, valid values are:
* NONE
 * BASE64
 * HEX
- `pwd_hash` (String) password hashing algorithm, valid values are:
* NONE (NOT recommended!)
* CRYPT (LDAP only)
* BCRYPT
* SHA-512
* SHA-256
* SHA-1
* MD5 (NOT recommended!)
- `salt_prefix` (String) fixed salt prefix for password hashing
- `salt_suffix` (String) fixed salt suffix for password hashing
- `saml_authn_ctx` (String) reported SAML2 password authentication context. Some proivders required a specific value.  Valid values are: 
* urn:oasis:names:tc:SAML:2.0:ac:classes:Password (default)
 * urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport

<a id="nestedblock--authn_basic--extension"></a>
### Nested Schema for `authn_basic.extension`

Required:

- `fqcn` (String) component java FQCN. Refers to the OSGi component type or Java class to be instantiated

Optional:

- `osgi_filter` (String) filter to locate the OSGi service (Only when extension type is SERVICE).
- `property` (Block Set) list of configuration properties and its values (only when extension type is INSTANCE) (see [below for nested schema](#nestedblock--authn_basic--extension--property))
- `type` (String) extension type: SERVICE (for OSGi service references) or INSTANCE (for creating a new instance).

<a id="nestedblock--authn_basic--extension--property"></a>
### Nested Schema for `authn_basic.extension.property`

Required:

- `name` (String) Name as the property
- `value` (String) Value as the property




<a id="nestedblock--authn_bind_ldap"></a>
### Nested Schema for `authn_bind_ldap`

Required:

- `password` (String) secret credential to connect to the LDAP server
- `provider_url` (String) LDAP server connection url: ldaps://localhost:636
- `username` (String) username credential to connect to the LDAP server
- `users_ctx_dn` (String) DN to search for users

Optional:

- `authentication` (String) credential to connect to the LDAP server
- `extension` (Block List) Allows you to use a custom component for a given resource.  Components are installed as OSGi bundles in the server.  You can refer to a component instance or create a new instance based on its class (see [below for nested schema](#nestedblock--authn_bind_ldap--extension))
- `initial_ctx_factory` (String) Java JNDI initial context factory (default: com.sun.jndi.ldap.LdapCtxFactory)
- `operational_attrs` (Boolean) Require LDAP operational attributes (useful for LDAP password policy management)
- `password_policy` (String) Support LDAP password policy management. Values : none, ldap-rfc-draft (default none)
- `perform_dn_search` (Boolean) Perform a user search by DN before authentiation
- `priority` (Number) authentiacation priority compared to other mechanisms (ascening order)
- `referrals` (String) how to process referrals in a directory node.  Values: follow, ignore
- `saml_authn_ctx` (String) reported SAML 2 authentication context class
- `search_scope` (String) LDAP search scope. Values : base, one, subtree, children
- `userid_attr` (String) The Idp will provide the configured user identifier, ignoring the requested type(SAML 2)

<a id="nestedblock--authn_bind_ldap--extension"></a>
### Nested Schema for `authn_bind_ldap.extension`

Required:

- `fqcn` (String) component java FQCN. Refers to the OSGi component type or Java class to be instantiated

Optional:

- `osgi_filter` (String) filter to locate the OSGi service (Only when extension type is SERVICE).
- `property` (Block Set) list of configuration properties and its values (only when extension type is INSTANCE) (see [below for nested schema](#nestedblock--authn_bind_ldap--extension--property))
- `type` (String) extension type: SERVICE (for OSGi service references) or INSTANCE (for creating a new instance).

<a id="nestedblock--authn_bind_ldap--extension--property"></a>
### Nested Schema for `authn_bind_ldap.extension.property`

Required:

- `name` (String) Name as the property
- `value` (String) Value as the property




<a id="nestedblock--authn_client_cert"></a>
### Nested Schema for `authn_client_cert`

Optional:

- `clr_enabled` (Boolean) authentiacation priority compared to other mechanisms (ascening order)
- `crl_refresh_seconds` (Number) authentiacation priority compared to other mechanisms (ascening order)
- `crl_url` (String) authentiacation priority compared to other mechanisms (ascening order)
- `extension` (Block List) Allows you to use a custom component for a given resource.  Components are installed as OSGi bundles in the server.  You can refer to a component instance or create a new instance based on its class (see [below for nested schema](#nestedblock--authn_client_cert--extension))
- `ocsp_enabled` (Boolean) authentiacation priority compared to other mechanisms (ascening order)
- `ocsp_server` (String) authentiacation priority compared to other mechanisms (ascening order)
- `ocspserver` (String) authentiacation priority compared to other mechanisms (ascening order)
- `priority` (Number) authentiacation priority compared to other mechanisms (ascening order)
- `uid` (String) authentiacation priority compared to other mechanisms (ascening order)

<a id="nestedblock--authn_client_cert--extension"></a>
### Nested Schema for `authn_client_cert.extension`

Required:

- `fqcn` (String) component java FQCN. Refers to the OSGi component type or Java class to be instantiated

Optional:

- `osgi_filter` (String) filter to locate the OSGi service (Only when extension type is SERVICE).
- `property` (Block Set) list of configuration properties and its values (only when extension type is INSTANCE) (see [below for nested schema](#nestedblock--authn_client_cert--extension--property))
- `type` (String) extension type: SERVICE (for OSGi service references) or INSTANCE (for creating a new instance).

<a id="nestedblock--authn_client_cert--extension--property"></a>
### Nested Schema for `authn_client_cert.extension.property`

Required:

- `name` (String) Name as the property
- `value` (String) Value as the property




<a id="nestedblock--authn_oauth2_pre"></a>
### Nested Schema for `authn_oauth2_pre`

Optional:

- `authn_service` (String) authentiacation priority compared to other mechanisms (ascening order)
- `extension` (Block List) Allows you to use a custom component for a given resource.  Components are installed as OSGi bundles in the server.  You can refer to a component instance or create a new instance based on its class (see [below for nested schema](#nestedblock--authn_oauth2_pre--extension))
- `external_auth` (Boolean) authentiacation priority compared to other mechanisms (ascening order)
- `priority` (Number) authentiacation priority compared to other mechanisms (ascening order)
- `remember_me` (Boolean) authentiacation priority compared to other mechanisms (ascening order)

<a id="nestedblock--authn_oauth2_pre--extension"></a>
### Nested Schema for `authn_oauth2_pre.extension`

Required:

- `fqcn` (String) component java FQCN. Refers to the OSGi component type or Java class to be instantiated

Optional:

- `osgi_filter` (String) filter to locate the OSGi service (Only when extension type is SERVICE).
- `property` (Block Set) list of configuration properties and its values (only when extension type is INSTANCE) (see [below for nested schema](#nestedblock--authn_oauth2_pre--extension--property))
- `type` (String) extension type: SERVICE (for OSGi service references) or INSTANCE (for creating a new instance).

<a id="nestedblock--authn_oauth2_pre--extension--property"></a>
### Nested Schema for `authn_oauth2_pre.extension.property`

Required:

- `name` (String) Name as the property
- `value` (String) Value as the property




<a id="nestedblock--authn_wia"></a>
### Nested Schema for `authn_wia`

Required:

- `domain` (String) windows domain
- `domain_controller` (String) domain controller server
- `host` (String) JOSSO hostname
- `keytab` (String) Kerberos keytab file
- `port` (Number) JOSSO server port
- `priority` (Number) authentiacation priority compared to other mechanisms (ascening order)
- `protocol` (String) JOSSO server protocol (http/https)
- `service_class` (String) authentiacation priority compared to other mechanisms (ascening order)
- `service_name` (String) authentiacation priority compared to other mechanisms (ascening order)

Optional:

- `extension` (Block List) Allows you to use a custom component for a given resource.  Components are installed as OSGi bundles in the server.  You can refer to a component instance or create a new instance based on its class (see [below for nested schema](#nestedblock--authn_wia--extension))
- `overwrite_kerberos_setup` (Boolean) override JOSSO kerberos configuration

<a id="nestedblock--authn_wia--extension"></a>
### Nested Schema for `authn_wia.extension`

Required:

- `fqcn` (String) component java FQCN. Refers to the OSGi component type or Java class to be instantiated

Optional:

- `osgi_filter` (String) filter to locate the OSGi service (Only when extension type is SERVICE).
- `property` (Block Set) list of configuration properties and its values (only when extension type is INSTANCE) (see [below for nested schema](#nestedblock--authn_wia--extension--property))
- `type` (String) extension type: SERVICE (for OSGi service references) or INSTANCE (for creating a new instance).

<a id="nestedblock--authn_wia--extension--property"></a>
### Nested Schema for `authn_wia.extension.property`

Required:

- `name` (String) Name as the property
- `value` (String) Value as the property




<a id="nestedblock--oauth2"></a>
### Nested Schema for `oauth2`

Required:

- `shared_key` (String) IDP secret key to be shared with the OAuth client

Optional:

- `enabled` (Boolean) enable OAuth2 protocol for this IDP
- `pwdless_authn_enabled` (Boolean) passwordless authentication enabled. Usefull for one-click logins
- `pwdless_authn_from` (String) passwordless authn subject FROM
- `pwdless_authn_subject` (String) message subject used during one-click login
- `pwdless_authn_template` (String) name of the message template sent to the user during one-click login
- `pwdless_authn_to` (String) passwordless authn subject TO
- `rememberme_token_validity` (Number) remember me token validity (sec, default 43200)
- `token_validity` (Number) token validity (sec, default 300)


<a id="nestedblock--oidc"></a>
### Nested Schema for `oidc`

Optional:

- `access_token_ttl` (Number) access token time to live (sec)
- `authz_code_ttl` (Number) authorization code time to live (sec)
- `enabled` (Boolean) enable OIDC for this IDP
- `id_token_ttl` (Number) id token time to live (sec)
- `user_claims_in_access_token` (Boolean) include user claims in access token


<a id="nestedblock--saml2"></a>
### Nested Schema for `saml2`

Optional:

- `bindings` (Block List, Max: 1) enabled SAML bindings (see [below for nested schema](#nestedblock--saml2--bindings))
- `encrypt_algorithm` (String) encrypt assertion algorithm
- `message_ttl` (Number) message ttl (sec)
- `message_ttl_tolerance` (Number) message ttl tolerance (sec)
- `sign_reqs` (Boolean) sign all requests to SPs
- `signature_hash` (String) signature hash algorithm
- `want_authn_req_signed` (Boolean) want authn requests signed by SPs
- `want_req_signed` (Boolean) want requests signed by SPs

<a id="nestedblock--saml2--bindings"></a>
### Nested Schema for `saml2.bindings`

Optional:

- `artifact` (Boolean) use Artifact binding
- `http_post` (Boolean) use HTTP POST binding
- `http_redirect` (Boolean) use HTTP REDIRECT binding
- `local` (Boolean) use LOCAL binding
- `soap` (Boolean) use SOAP binding



<a id="nestedblock--sp"></a>
### Nested Schema for `sp`

Required:

- `name` (String) name of the trusted sp. It normally is the name of the application plus the -sp suffix

Optional:

- `saml2` (Block List, Max: 1) IDP SAML2 protocol settings (see [below for nested schema](#nestedblock--sp--saml2))

<a id="nestedblock--sp--saml2"></a>
### Nested Schema for `sp.saml2`

Optional:

- `bindings` (Block List, Max: 1) enabled SAML bindings (see [below for nested schema](#nestedblock--sp--saml2--bindings))
- `encrypt_algorithm` (String) encrypt assertion algorithm
- `message_ttl` (Number) message ttl (sec)
- `message_ttl_tolerance` (Number) message ttl tolerance (sec)
- `sign_reqs` (Boolean) sign all requests to SPs
- `signature_hash` (String) signature hash algorithm
- `want_authn_req_signed` (Boolean) want authn requests signed by SPs
- `want_req_signed` (Boolean) want requests signed by SPs

<a id="nestedblock--sp--saml2--bindings"></a>
### Nested Schema for `sp.saml2.bindings`

Optional:

- `artifact` (Boolean) use Artifact binding
- `http_post` (Boolean) use HTTP POST binding
- `http_redirect` (Boolean) use HTTP REDIRECT binding
- `local` (Boolean) use LOCAL binding
- `soap` (Boolean) use SOAP binding




<a id="nestedblock--subject_authn_policies"></a>
### Nested Schema for `subject_authn_policies`

Required:

- `name` (String) Todo


